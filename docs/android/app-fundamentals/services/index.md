---
title: Android 서비스 만들기
description: 이 가이드에서는 Xamarin.Android 서비스는 활성 사용자 인터페이스 없이 수행 될 작업을 허용 하는 Android 구성 요소를 설명 합니다. 서비스는 시간이 오래 걸리는 계산을 파일, 음악을 재생 다운로드와 같은 백그라운드에서 수행 되는 작업에 대 한 매우 자주 사용 됩니다 및 등입니다. 서비스에 대 한 적합 한 다양 한 시나리오에 설명 하 고 장기 실행 백그라운드 작업을 수행 하기 위한와 원격 프로시저 호출에 대 한 인터페이스를 제공 하기 위해 구현 하는 방법을 보여 줍니다.
ms.prod: xamarin
ms.assetid: BA371A59-6F7A-F62A-02FC-28253504ACC9
ms.technology: xamarin-android
author: conceptdev
ms.author: crdun
ms.date: 03/19/2018
ms.openlocfilehash: 4ae86ca5fa47169bb5d78eb9d1116e419c23ed6d
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61012515"
---
# <a name="creating-android-services"></a>Android 서비스 만들기

_이 가이드에서는 Xamarin.Android 서비스는 활성 사용자 인터페이스 없이 수행 될 작업을 허용 하는 Android 구성 요소를 설명 합니다. 서비스는 시간이 오래 걸리는 계산을 파일, 음악을 재생 다운로드와 같은 백그라운드에서 수행 되는 작업에 대 한 매우 자주 사용 됩니다 및 등입니다. 서비스에 대 한 적합 한 다양 한 시나리오에 설명 하 고 장기 실행 백그라운드 작업을 수행 하기 위한와 원격 프로시저 호출에 대 한 인터페이스를 제공 하기 위해 구현 하는 방법을 보여 줍니다._

## <a name="android-services-overview"></a>Android 서비스 개요

모바일 앱은 데스크톱 앱과 다릅니다. 데스크톱과 달리 모바일 장치에는 화면 창, 메모리, 저장소 공간 및 연결된 전원 공급 장치 등의 리소스들이 없습니다. 이러한 제약 조건들은 모바일의 작동 방식을 제한합니다. 예를 들어 모바일 장치에서는 일반적으로 작은 화면에 하나의 앱(즉, 활동)만 표시됩니다. 다른 활동은 백그라운드로 이동되어 일시 중단된 상태가 되며 아무런 작동도 할 수 없습니다. 그러나 Android 응용 프로그램은 백그라운드로 이동된 후에도 작동하는 것이 가능합니다. 

Android 응용 프로그램은 다음 네 가지 기본 구성 요소 중 적어도 하나의 요소로: _활동_, _브로드캐스트 수신기_를 _콘텐츠 공급자_, 및 _Services_합니다. 작업은 응용 프로그램과 상호 작용할 수 있도록 허용 하는 UI를 제공 하기 때문에 많은 유용한 Android 응용 프로그램의 토대입니다. 그러나 수행 동시 또는 백그라운드 작업을 하더라도 작업 되지 않을 것이 가장 좋습니다.
 
Android에서 백그라운드 작업에 대 한 기본 메커니즘은는 _서비스_합니다. Android 서비스는 사용자 인터페이스 없이 작업을 수행 하도록 디자인 된 구성 요소입니다. 서비스 파일을 다운로드 하 고 음악을 재생 하 하거나 이미지에 필터를 적용 될 수 있습니다. 서비스 프로세스 간 통신에 사용할 수도 있습니다 (_IPC_) Android 응용 프로그램 간에 합니다. 예를 들어 하나의 Android 앱 다른 앱에서 음악 플레이어를 사용 하거나 앱 서비스를 통해 다른 앱으로 (예: 사람의 연락처 정보) 데이터를 노출할 수 있습니다. 

서비스 및 백그라운드 작업을 수행 하는 기능을 원활 하 고 유연한 사용자 인터페이스를 제공 하는 데 중요 한 경우 모든 Android 응용 프로그램에는 _주 스레드_ (라고도 _UI 스레드_) 활동 실행 됩니다. 장치 응답을 유지 하려면 Android 초당 60 프레임 속도로 사용자 인터페이스를 업데이트할 수 있어야 합니다. 주 스레드에서 너무 많은 작업을 수행 하는 Android 앱 경우 Android 프레임은 삭제에 UI를 비정상적으로 표시 하면 (또한 라고도 _janky_). 이 두 프레임이 약 16 밀리초 (1 모든 60 프레임을 두 번째) 사이의 시간 범위에서 UI 스레드에서 수행 된 모든 작업은 완료 하는 것을 의미 합니다. 

이 문제를 해결 하기 위해 개발자는 UI를 차단 하는 몇 가지 작업을 수행 하는 작업에서 스레드를 사용할 수 있습니다. 그러나이 문제가 발생할 수 있습니다. Android 파괴 되며 활동의 여러 인스턴스를 다시 매우 가능성이 있습니다. 그러나 Android 메모리 누수가 발생할 수 있는 스레드를 자동으로 삭제 하지 않습니다. 대표적인 예로이 경우는 [장치를 회전](~/android/app-fundamentals/handling-rotation.md) &ndash; Android 활동의 인스턴스를 파괴 하 고 새로 다시 시도 됩니다:

![장치를 회전할 때 인스턴스 1 파괴 되 고 인스턴스 2 만들어집니다.](images/image-01.png)

이 잠재적인 메모리 누수를 &ndash; 활동의 첫 번째 인스턴스를 만든 스레드는 계속 실행 됩니다. 스레드 활동의 첫 번째 인스턴스에 대 한 참조에이 가비지 수집 개체에서에서 Android를 못하게 됩니다. 그러나 활동의 두 번째 인스턴스 계속 만들어집니다 (함에 새 스레드를 만들 수 있습니다). 여러 번 빠르게 연속적으로에서 장치가 회전 RAM을 모두 소모 하 고 메모리를 회수 하는 전체 응용 프로그램을 종료 하는 Android를 강제로 수 있습니다.

일반적으로 작업을 수행할 수는 작업 보다 수명이 길 해야 다음 서비스를 작성 해야 해당 작업을 수행 합니다. 그러나 작업 활동의 컨텍스트에서 해당만 이면 다음 작업을 수행 하기 위한 스레드를 만들어 더 적절할 수 있습니다. 예를 들어, 사진 갤러리 앱에 추가 된 사진에 대 한 미리 보기 만들기 서비스에서 발생 아마도 해야 합니다. 그러나 스레드 활동 프로그램이 전경에 있는 동안에 들 해야 하는 일부 음악을 재생 하는 데 더 적절할 수 있습니다.

백그라운드 작업 광범위 한 두 가지로 구분할 수 있습니다.

1. **장기 실행 작업** &ndash; 명시적으로 중지 될 때까지 진행 중인 작업입니다. 예는 _장기 실행 작업_ 음악을 스트림 하는 앱 또는 센서에서 수집 된 데이터를 모니터링 해야 하는 합니다. 이러한 작업은 응용 프로그램에 표시 되는 사용자 인터페이스가 없는 경우에 실행 해야 합니다.
2. **정기 작업** &ndash; (라고도 _작업_)는 정기적인 작업은 일정에서 실행 되 고 비교적 짧은 기간 동안 (몇 초)입니다 (예: 하루에 한 번 또는 일주일에 한 번만 다음 60 초)입니다. 이 예가 인터넷에서 파일을 다운로드 되었거나의 미리 보기 이미지를 생성 합니다.

네 가지 다른 유형의 Android 서비스는

* **서비스에 바인딩된** &ndash; A _바인딩된 서비스_ 는 일부 다른 구성 요소 (일반적으로 활동) 바인딩되어 있는 서비스입니다. 바인딩된 서비스 바인딩된 구성 요소 및 상호 작용 하도록 서비스를 허용 하는 인터페이스를 제공 합니다. 더 많은 클라이언트가 서비스에 바인딩된가 되 면 Android는를 서비스를 종료 합니다. 

* **`IntentService`** &ndash; _`IntentService`_ 의 특수화 된 서브 클래스는 `Service` 서비스 만들기 및 사용을 간소화 하는 클래스입니다. `IntentService` 은 개별 자치 호출을 처리 하기 위한 것입니다. 여러 호출을 처리할 수 있습니다 동시에, 서비스와 달리를 `IntentService` 비슷합니다는 _큐 프로세서 작업_ &ndash; 작업 큐에 저장 및 `IntentService` 단일 작업자 스레드에서 한 번에 하나의 각 작업을 처리 합니다. 일반적으로`IntentService` 활동 또는 조각에 바인딩되어 있지 않습니다. 

* **서비스를 시작 했습니다** &ndash; A _서비스를 시작_ 는 몇 가지 기타 Android 구성 요소 (예: 활동) 하 여 시작 된 무언가 명시적으로 지시 될 때까지 백그라운드에서 지속적으로 실행 되는 서비스는 서비스를 중지 합니다. 바인딩된 서비스와 달리 서비스를 시작된 되지 않은 모든 클라이언트에 직접 바인딩된 합니다. 따라서 필요에 따라 정상적으로 다시 수 있도록 시작된 된 서비스를 디자인 하려면 반드시 합니다.

* **하이브리드 서비스** &ndash; 는 _하이브리드 서비스_ 는 서비스의 특징이 있는 _서비스를 시작 했습니다_ 및 _바인딩된 서비스_합니다. 구성 요소에 바인딩합니다 때나 일부 이벤트에 의해 시작 될 수 있습니다 하 여 하이브리드 서비스를 시작할 수 있습니다. 클라이언트 구성 요소 수 또는 하이브리드 서비스에 연결 되어 있지 않습니다. 를 중지 하도록 지시 받고 명시적으로 하거나에 바인딩된 자세한 클라이언트가 없는 때까지 하이브리드 서비스를 계속 실행 됩니다.

어떤 유형의 서비스를 사용 하 여 응용 프로그램 요구 사항에 따라 매우 다릅니다. 일반적으로는 `IntentService` 또는 바인딩된 서비스 되므로 Android 응용 프로그램을 수행 해야 하는 대부분의 작업에 대 한 충분 한 기본 서비스의 이러한 두 형식 중 하나에 부여 해야 합니다. `IntentService` 바인딩된 서비스는 활동/조각와 자주 상호 작용에 필요한 경우 적합할 수는 있지만 파일을 다운로드 하는 등의 "원 샷" 작업에 대 한 것이 좋습니다. 

이라는 특수 한 하위 범주는 대부분의 서비스를 백그라운드에서 실행 하는 동안에 _포그라운드 서비스_합니다. (예: 음악을 재생) 사용자에 대 한 몇 가지 작업을 수행 하는 일반 서비스와 비교 높은 우선 순위를 지정 되는 서비스입니다. 

자체 프로세스에서 동일한 장치에 서비스를 실행할 수 이기도,이 때때로 이라고 하는 _원격 서비스_ 또는 _out of process 서비스_합니다. 이 만들려는 더 많은 노력이 필요 하지만 다른 응용 프로그램과 기능을 공유 하는 응용 프로그램을 필요로 하는 경우에 유용할 수 있습니다 하 고, 일부 경우에는 사용자 환경을 향상 시키는 응용 프로그램의 합니다. 

### <a name="background-execution-limits-in-android-80"></a>Android 8.0의 백그라운드 실행 제한

Android 8.0 (API 레벨 26)부터 Android 응용 프로그램을 더 이상 자유롭게 백그라운드에서 실행할 수가 없습니다. 포그라운드에 있을 때 앱을 시작 하 고 제한 없이 서비스를 실행할 수 있습니다. 응용 프로그램이 백그라운드로 움직이면 Android는 특정 시작 및 서비스를 사용 하는 시간의 양을 앱에 부여 합니다. 해당 시간이 경과한 후 앱에서 모든 서비스를 더 이상 시작할 수 및 시작 되었던 모든 서비스가 종료 됩니다. 이 시점에서 작업을 수행 하는 앱에 대 한 가능한 아닙니다. Android 응용 프로그램이 포그라운드에서 다음 조건 중 하나가 충족 될 경우 간주 합니다.

* 작업 (시작 또는 일시 중지)을 볼 수 있습니다.
* 앱은 포그라운드 서비스를 시작 했습니다.
* 다른 앱이 백그라운드에서으로 하는 앱에서 구성 요소를 사용 하는 하며 이 예는 포그라운드에 응용 프로그램 A를 제공 하는 서비스에 바인딩된 경우 응용 프로그램 응용 프로그램 B도 됩니다. 포그라운드에서 것으로 간주 하 고 백그라운드에서 사용 하기에 Android로 종료 되지 않았습니다.

where, 백그라운드에서 실행 되는 앱에도 Android 앱의 절전 모드 되며 앱 일부 작업을 수행 하도록 허용 잠시 후에 이러한 제한이 완화 경우가 있습니다.
* 앱에서 Firebase 클라우드 메시지를 받으면 높은 우선 순위입니다.
* 앱은 브로드캐스트를 받습니다. 
* 응용 프로그램을 받아 실행을 `PendingIntent` 알림 응답에서 합니다.

기존 Xamarin.Android 응용 프로그램 Android 8.0에서 발생할 수 있는 문제를 방지 하려면 백그라운드 작업 수행 방법을 변경 해야 할 수 있습니다. Android 서비스의 몇 가지 실용적인 대안은 다음과 같습니다.

* **Android 작업 스케줄러를 사용 하 여 백그라운드에서 실행 하는 작업을 예약 또는 [Firebase 작업 디스패처](~/android/platform/firebase-job-dispatcher.md)**  &ndash; 에서백그라운드작업을분리하는응용프로그램프레임워크를제공하는이러한두라이브러리_작업_, 불연속 단위 작업입니다. 작업을 실행할 때 앱에 대 한 몇 가지 기준 함께 운영 체제를 사용 하 여 작업을 예약한 다음 수 있습니다.
* **전경에서 서비스를 시작할** &ndash; 포그라운드 서비스 앱을 백그라운드에서 일부 작업을 수행 해야 하면 유용 하며 사용자는 작업을 사용 하 여 주기적으로 상호 작용 해야 할 수 있습니다. 포그라운드 서비스 사용자가 앱을 백그라운드 작업 실행을 모니터링 하거나 작업을 사용 하 여 상호 작용 하는 방법을 제공 알 수 있도록 영구 알림이 표시 됩니다. 이 예제는 사용자에 게 포드캐스트 재생 되었거나 아마도 나중에 사용 될 수 있도록 podcast 에피소드를 다운로드 하는 광고 업체가 팟캐스팅 앱을 것입니다. 
* **높은 우선 순위 Firebase 클라우드 메시지 (FCM)를 사용 하 여** &ndash; 때 Android 앱에 대 한 우선 순위 FCM 수신, 짧은 기간에 대 한 백그라운드에서 서비스를 실행 하는 앱 허용 됩니다. 이 백그라운드에서 앱을 폴링하는 백그라운드 서비스에 대 한 좋은 대안은 것입니다. 
* **전경으로 앱을 제공 하는 경우에 대 한 작업을 연기** &ndash; 이전 솔루션 중 없음,이 경우 앱을 일시 중지 및 다시 시작 작업은 응용 프로그램은 전경으로 고유한 방식으로 개발 해야 합니다.

## <a name="related-links"></a>관련 링크

* [Android Oreo 백그라운드 실행 제한](https://www.youtube.com/watch?v=Pumf_4yjTMc)
